<?php include 'cdns.php'; include 'config.php'; session_start();?><style type="text/css">	.pagethings{		position: absolute;		left: 200px;		padding: 20px;	}	.nshw{		display: none;	}	.lightlabel{		background-color: #ccc !important;		padding-left: 5px !important;		font-size: 12px;		font-weight: bold;		padding: 0px;	}	.fstable tbody th{	  color: #000;	  font-size: 12px;	  font-weight: bold;	  padding: 5px !important;	}	.fstable tbody td{	  padding: 1px;	}	.frminp{	  padding: 4px !important;	  height:25px;	  border-radius: 4px;	  font-size: 11px;	  font-weight:550;	}	.frmbtn{	  padding: 2px 4px !important;	  font-size: 11px;	}	body{		background-color: #EDEDED;	}	.estable thead th,.estable tbody th{	  font-size: 12px !important;	  padding: 1px 2px !important;	  font-weight: 500;	  border:2px solid #ccc;	  margin:0px;	}	.estable thead th{	  background-color:#b7e0f4;	  color: #000;	  font-size: 15px;	  font-weight: bold;	  padding: 7px 3px !important;	}	.estable tbody td{	  background-color: #fff !important;	}	label{		font-size: 12px;		font-weight: bold;		cursor: pointer;		padding-left:10px;	}</style><div id="savmsg" class="alert alert-success frminp" style="display:none ;">Saved Successfully!</div><?phpif(isset($_REQUEST['added']) && $_REQUEST['added']=='yes'){	?>	<script type="text/javascript">		$("#savmsg").show(300);		setTimeout(function(){ $("#savmsg").hide(300);  }, 3000);	</script>	<?php}?><?php/*============================================here taking all the districts and putting on a array, so in below Tahsil loop we don't have to fetch all states again and again...==============================================*/$alls=mysql_query('SELECT * FROM `state`');while ($allsd=mysql_fetch_assoc($alls)) {	$sarr[$allsd['StateId']]=$allsd['StateName'];}$allo=mysql_query('SELECT * FROM `organiser`');while ($allod=mysql_fetch_assoc($allo)) {	$oarr[$allod['oid']]=$allod['oname'];}$us=mysql_query('SELECT * FROM `users` where uId='.$_REQUEST['uid']);$usd=mysql_fetch_assoc($us);?><form id="farmertable"  enctype="multipart/form-data" method="post" action="mastersAjax.php">	<input type="hidden" name="act" value="addfarmer">	<table class=" fstable table table-bordered">				<tbody >		<tr>			<td colspan="8" style="font-weight: bold;"><?=$usd['uName']?></td>		</tr>		<tr>			<td colspan="8" class="lightlabel">Crop Permissions</td>		</tr>		<tr>			<td>				<table class=" estable">										<tbody>					<tr>						<td>							<table class=" estable">								<thead>								<tr>									<th style="width:150px;">                                     <?php /*									<label> <input id="allCrops" type="checkbox" name="allCrops" onchange="allpage(this,'Masters')" disabled>All Crops</label>                                     */?>																		</th> 								</tr>								</thead>								<tbody>								<?php								$allc=mysql_query("SELECT * FROM `crop` order by cropname asc");								while ($allcd=mysql_fetch_assoc($allc)) {									?>									<tr>										<td>											<label id="lbpg<?=$allcd['cropid']?>" style="width: 100%;">											<input id="lbchk<?=$allcd['cropid']?>" type="checkbox" class="Masters" onchange="changeit(this,'<?=$allcd['cropid']?>','<?=$_REQUEST['uid']?>')">											<?=$allcd['cropname']?>											</label>										</td>									</tr>									<?php								}								?>																</tbody>							</table>													</td>																	</tr>					</tbody>				</table>			</td>		</tr>				</tbody>			</table></form><button type="button" class="frmbtn btn btn-sm btn-danger" style="width:100px;position: absolute;top:4px;right: 4px;" onclick="closediv('<?=$_REQUEST['uid']?>')"  >Close</button>				</center><script type="text/javascript">	function closediv(uid){		$('#editUDiv', window.parent.document).hide(500);		$('#eCropbtn'+uid, window.parent.document).show();		$('#editingCropbtn'+uid, window.parent.document).hide();		window.parent.document.getElementById('addfarbtn').style.display='block';	}</script><!-- this dump div is being used on js lstate function to take js scripts from ajax file  --><div id="dump">	&nbsp;</div><!-- this dump div is being used on js lstate function to take js scripts from ajax file  --><script type="text/javascript">	function changeit(th,cid,uid){				if($(th).prop("checked") == true){            $(th).parent().css("background-color","#4CAF50");            $(th).parent().css("color","#fff");            $.post("mastersAjax.php",{ act:'addusercrop',cid:cid,uid:uid },function(data) {});            $.post("mastersAjax.php",{ act:'getUserCropsCountCheckWithAll',cid:cid,uid:uid },function(data){            	if(data.includes("allselected")){					$("#allCrops").prop("checked",true);            	}            });                    }else if($(th).prop("checked") == false){            $(th).parent().css("background-color","#fff");            $(th).parent().css("color","#000");            $.post("mastersAjax.php",{ act:'removeusercrop',cid:cid,uid:uid },function(data){});            $("#allCrops").prop("checked",false);                   }        	}	function allpage(th,pgs){		if($(th).prop('checked') == true){			$("."+pgs).prop('checked', true);			$("."+pgs).trigger('change');		}else if($(th).prop('checked') == false){			$("."+pgs).prop('checked', false);			$("."+pgs).trigger('change');		}	}</script><?php$sel=mysql_query("SELECT * FROM `user_crop` where `uId`='".$_REQUEST['uid']."' and sts='A'");while ($sels=mysql_fetch_assoc($sel)) {	?>	<script type="text/javascript">		$("<?='#lbchk'.$sels['cropid']?>").prop("checked",true);		$("<?='#lbpg'.$sels['cropid']?>").css("background-color",'#4CAF50');		$("<?='#lbpg'.$sels['cropid']?>").css("color",'#fff');			</script>	<?php}?><?php/* ================================================================================================================	checking checkboxes of selection "all" if all submenus checked code here...........   ================================================================================================================*/$selAllCrop=mysql_query("SELECT * FROM `crop` ");$selAllCropCount=mysql_num_rows($selAllCrop);$userCrops=mysql_num_rows($sel);if($selAllCropCount == $userCrops){	?>	<script type="text/javascript">		$("#allCrops").prop("checked",true);	</script>	<?php}/* ================================================================================================================	checking checkboxes of selection "all" if all submenus checked code here...........   ================================================================================================================*/?>