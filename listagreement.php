<?phpinclude 'sidemenu.php';// date("t",strtotime($_POST['Year'].'-'.$_POST['Month'].'-01'))?><style type="text/css">	.pagethings{		position: absolute;		left: 200px;		padding: 20px;	}	.nshw{		display: none;	}	.ftable thead th,.ftable tbody th,.ftable tbody td{	  font-size: 12px !important;	  padding: 1px 2px !important;	  text-align: center;	  font-weight: 500;	  border:2px solid #ccc;	  margin:0px;	}	.ftable thead th{	  background-color:#e3f1f7;	  color: #000;	  font-size: 13px;	  font-weight: bold;	  padding: 7px 3px !important;	}	.ftable tbody td{	  background-color: #fff !important;	}	.dtinp{		padding: 4px;		border-radius: 5px;		border:1px solid #c1c1c1;		width: 90px;		text-align: center;	}</style><?php$allo=mysql_query("SELECT * FROM `organiser` o inner join user_location l on l.state_id=o.state_id where l.uid=".$_SESSION['uId']." AND l.sts='A' order by oname asc");while($allod=mysql_fetch_assoc($allo)){	$oarr[$allod['oid']]=strtoupper($allod['oname']);}$allc=mysql_query("SELECT c.* FROM crop c, user_crop uc where c.cropid=uc.cropid and uc.uid='".$_SESSION['uId']."' order by c.cropname");while ($allcd=mysql_fetch_assoc($allc)) {	$crarr[$allcd['cropid']]=strtoupper($allcd['cropname']);}$allf=mysql_query("SELECT f.* FROM farmers f, user_location ul WHERE f.state_id!=0 and ul.state_id!=0 and f.state_id=ul.state_id and ul.uid='".$_SESSION['uId']."' and ul.sts='A' order by fname asc");while ($allfd=mysql_fetch_assoc($allf)) {	$farr[$allfd['fid']]=strtoupper($allfd['fname'].' - '.$allfd['father_name']);}function gethierarchy($uid){	$id=array($uid);		if($_SESSION['uType']=='S'){		$sel=mysql_query("select uId from users");		while($seld = mysql_fetch_assoc($sel)){			$idc = array($seld['uId']);			$id = array_merge($id,$idc);		}	}else{		$sel=mysql_query("select uId from users where uReporting='".$uid."'");		if(mysql_num_rows($sel) > 0){			while($seld = mysql_fetch_assoc($sel)){				$idc = array($seld['uId']);				$id = array_merge($id,$idc,gethierarchy($seld['uId']));			}		}	}	return $id;	}$allu=mysql_query("SELECT * FROM `users` where uStatus='A' AND uPost!=4 order by uName asc");while ($allud=mysql_fetch_assoc($allu)) {	$uarr[$allud['uId']]=strtoupper($allud['uName']);}?><div class="pagethings" style="width:85%;">		<div id="editAgrDiv" style="display: none;margin-bottom: 10px;padding:2px;background-color: #EDEDED;border:2px solid #ccc;">		<h6 style="font-weight: bold;" id="actiontext"></h6>		<iframe id="editAgrIframe" src="" style="width:100%;height:465px;border:0px;"></iframe>	</div>	<div id="addcrtbl" style="margin-bottom: 10px;padding:2px;background-color: #EDEDED;border:2px solid #ccc;overflow:scroll;">		<h6 style="font-weight: bold;">Report</h6>		<table class="ftable" style="margin-bottom:2px;">			<thead>				<tr>				    <th style="width:150px;">&nbsp;Season:<br> <br> <?php $sSe=mysql_query("select * from view_season where SesId=1"); $rSe=mysql_fetch_assoc($sSe);$sVd=mysql_query("select * from app_version where VersionId=1"); $rVd=mysql_fetch_assoc($sVd); $Kdf=date("d-m-Y",strtotime($rVd['Kharif_From'])); $Kdt=date("d-m-Y",strtotime($rVd['Kharif_To']));$Rdf=date("d-m-Y",strtotime($rVd['Rabi_From']));$Rdt=date("d-m-Y",strtotime($rVd['Rabi_To']));$Sdf=date("d-m-Y",strtotime($rVd['Summer_From']));$Sdt=date("d-m-Y",strtotime($rVd['Summer_To']));//if($rSe['Kharif']=='Y'){ $Df=$Kdf; $Dt=$Kdt; }//elseif($rSe['Rabi']=='Y'){ $Df=$Rdf; $Dt=$Rdt; }//elseif($rSe['Summer']=='Y'){ $Df=$Sdf; $Dt=$Sdt; }$cD=date("Y-m-d");if($cD>=$rVd['Kharif_From'] && $cD<=$rVd['Kharif_To']){ $Df=$Kdf; $Dt=$Kdt; }elseif($cD>=$rVd['Rabi_From'] && $cD<=$rVd['Rabi_To']){ $Df=$Rdf; $Dt=$Rdt; }elseif($cD>=$rVd['Summer_From'] && $cD<=$rVd['Summer_To']){ $Df=$Sdf; $Dt=$Sdt; }?><input type="hidden" id="Kdf" value="<?=$Kdf?>" /><input type="hidden" id="Kdt" value="<?=$Kdt?>" /><input type="hidden" id="Rdf" value="<?=$Rdf?>" /><input type="hidden" id="Rdt" value="<?=$Rdt?>" /><input type="hidden" id="Sdf" value="<?=$Sdf?>" /><input type="hidden" id="Sdt" value="<?=$Sdt?>" />				    	<label id="klabel" for="kharif" style="padding: 4px;border-radius: 4px;cursor:pointer;<?php if($cD>=$rVd['Kharif_From'] && $cD<=$rVd['Kharif_To']){ ?>background-color:green;color:white;<?php } ?>"><input type="radio" name="season" value="kharif" id="kharif" <?php if($cD>=$rVd['Kharif_From'] && $cD<=$rVd['Kharif_To']){echo 'checked';} ?> onclick="setseason('kharif')"> Kharif </label>			           &nbsp;				    	<label id="rlabel" for="rabi"  style="padding: 4px;border-radius: 4px;cursor:pointer;<?php if($cD>=$rVd['Rabi_From'] && $cD<=$rVd['Rabi_To']){ ?>background-color:green;color:white;<?php } ?>"><input type="radio" name="season" value="rabi" id="rabi" <?php if($cD>=$rVd['Rabi_From'] && $cD<=$rVd['Rabi_To']){echo 'checked';} ?> onclick="setseason('rabi')"> Rabi </label>				    					    		<br />				    	<label id="slabel" for="summer"  style="padding: 4px;border-radius: 4px;cursor:pointer;				    	<?php if($cD>=$rVd['Summer_From'] && $cD<=$rVd['Summer_To']){ ?>background-color:green;color:white;<?php } ?>"><input type="radio" name="season" value="summer" id="summer" <?php if($cD>=$rVd['Summer_From'] && $cD<=$rVd['Summer_To']){echo 'checked';} ?> onclick="setseason('summer')"> Summer </label>				    	<script type="text/javascript">				    		function setseason(se){				    			var curdate = $('#from').val();				    			var curyear = curdate.split("-");				    			curyear = curyear[2];				    			var nextyear = parseInt(curyear)+1;				    			if(se=='kharif'){				    				$('#from').val($('#Kdf').val());				    				$('#to').val($('#Kdt').val());				    				$('#klabel').css('background-color','green');				    				$('#klabel').css('color','white');				    				$('#rlabel').css('background-color','');				    				$('#rlabel').css('color','');				    				$('#slabel').css('background-color','');				    				$('#slabel').css('color','');				    			}else if(se == 'rabi'){				    				$('#from').val($('#Rdf').val());				    				$('#to').val($('#Rdt').val());				    				$('#rlabel').css('background-color','green');				    				$('#rlabel').css('color','white');				    				$('#klabel').css('background-color','');				    				$('#klabel').css('color','');				    				$('#slabel').css('background-color','');				    				$('#slabel').css('color','');				    								    			}else if(se == 'summer'){				    				$('#from').val($('#Sdf').val());				    				$('#to').val($('#Sdt').val());				    				$('#slabel').css('background-color','green');				    				$('#slabel').css('color','white');				    				$('#klabel').css('background-color','');				    				$('#klabel').css('color','');				    				$('#rlabel').css('background-color','');				    				$('#rlabel').css('color','');				    			}				    		}				    	</script>				    </th>				    <th>&nbsp;From: <input type="" class="dtinp" id="from" value="<?=$Df;?>" autocomplete="off"><br><br>				    				    To: <input type="" class="dtinp" id="to" value="<?=$Dt;?>" autocomplete="off">				    </th>														<th>&nbsp;						Crop: 						<select id="crop">							<option value="">All</option>							<?php foreach ($crarr as $key => $value) { ?>							<option value="<?=$key?>" ><?=$value?></option>							<?php } ?>													</select>&nbsp;					</th>					<!-- 						==========================================================================================						here farmer filter and organiser filter displayed because user asked to removed 						===========================================================================================					-->					<link rel="stylesheet" href="search/select2.min.css" />                    <!--<style>.select2-dropdown {top: 22px !important; left: 8px !important;}</style>			        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>-->										<th style="display: block;">&nbsp;						Farmer: 						<select id="secondparty" >							<option  value="">All</option>							<?php foreach ($farr as $key => $value) { ?>							<option value="<?=$key?>"  ><?=ucwords(strtolower($value))?></option>							<?php } ?>						</select>&nbsp;					</th>					<th style="display: block;">&nbsp;						Organiser: 						<select id="orgr">							<option value="">All</option>							<?php foreach ($oarr as $key => $value) { ?>							<option value="<?=$key?>" ><?=$value?></option>							<?php } ?>						</select>&nbsp;					</th>										<th style="<?php if($_SESSION['uType']=='U'){echo "display: none;";}?>" >&nbsp;						<?php						$usr = array_unique(gethierarchy($_SESSION['uId']));						// print_r($usr);						?>						Users: 						<select id="users">							<option value="">All</option>							<?php foreach ($uarr as $key => $value) { ?>							<option value="<?=$key?>"><?=$value?></option>							<?php /*?><option value="<?=$value?>" ><?=$uarr[$value]?></option><?php */?>							<?php } ?>						</select>&nbsp;					</th>																			<th>					<button class="btn btn-sm btn-primary frmbtn" onclick="agreeSearch()">&emsp;Search&emsp;</button>					</th>				</tr>								<tr>				<th style="display: block;">&nbsp;						Farmer: 						<select id="secondparty" >							<option  value="">All</option>							<?php foreach ($farr as $key => $value) { ?>							<option value="<?=$key?>"  ><?=ucwords(strtolower($value))?></option>							<?php } ?>						</select>&nbsp;					</th>                 </tr>			</thead>		</table>		<table class=" estable table table-bordered" style="width:100%;">			<thead>				<tr>					<th rowspan="2" style="width:40px;">S.No</th>					<th rowspan="2" style="width:80px;">Agreement<br />ID</th>					<th rowspan="2" style="width:80px;">Agreement<br />Date</th>					<th rowspan="2" style="width:60px;">Crop</th>					<th rowspan="2" style="width:90px;">FSCode<br />Female / Male</th>					<th rowspan="2" style="width:100px;">Organiser<br />Name</th>					<th rowspan="2" style="width:100px;">Farmer Name</th>					<th rowspan="2" style="width:100px;">Father Name</th>					<th rowspan="2" style="width:100px;">Production<br />Person</th>					<th rowspan="2" style="width:100px;">Production<br />Executive</th>					<!--<th>Farmer Id</th>-->										<th colspan="2">Farmer Address</th>					<th colspan="2">Prod. Location</th>					<th rowspan="2" style="width:50px;">Sow<br />Acre</th>					<th rowspan="2" style="width:50px;">Stand<br />Acre<br />(GPS )</th>					<th rowspan="2" style="width:20px;">Edit</th>				</tr> 				<tr>					<th style="width:80px;">Village-Tahsil</th>					<th style="width:80px;">District-State</th>					<th style="width:80px;">Village-Tahsil</th>					<th style="width:80px;">District-State</th>				</tr>			</thead>			<tbody id="reportBody">							</tbody>		</table>	</div>	</div><script src="search/select2.min.js"></script><script type="text/javascript"> $("#secondparty").select2( { placeholder:"", allowClear:true } );</script><script>	$('#from').datepicker({format:'dd-mm-yyyy',});	$('#to').datepicker({format:'dd-mm-yyyy',});	function agreeSearch(page){		var crop = $('#crop').val();		var secondparty = $('#secondparty').val(); 			var orgr = $('#orgr').val();		var from = $('#from').val();		var to = $('#to').val();		var users = $('#users').val();		$.post("exportimportAjax.php",{ act:'get_report_list',page:page,crop:crop,orgr:orgr,from:from,to:to,secondparty:secondparty,users:users},function(data) { //alert(data);			$('#reportBody').html(data);			// console.log(data);				    });	}	function pad2(number) {	    return (number < 10 ? '0' : '') + number;	}	$(document).ready(function(){		/* 		==========================================================================================================			below code is for setting and showing "from date" and "to date" to last 7 days to today and showing			last 7days result by default page load		=============================================================================================================		*/		var from = $('#from').val();		var to = $('#to').val();		if(from=='' && to==''){			var d = new Date();			var week = new Date();			week.setDate(d.getDate()-1);			var dd = d.getDate();			var dm = d.getMonth()+1;			var dy = d.getFullYear();			d = pad2(dd) + '-' + pad2(dm) + '-' + dy;			$('#to').val(d);			var wd = week.getDate();			var wm = week.getMonth()+1;			var wy = week.getFullYear();			week = pad2(wd) + '-' + pad2(wm) + '-' + wy;			$('#from').val(week);			$.post("exportimportAjax.php",{ act:'get_report_list',from:week,to:d},function(data) {				$('#reportBody').html(data);				// console.log(data);		    });		}					});		function editagri(agid,agyear){ //alert(agid+"-"+agyear);		$('#editAgrDiv').show(1500);		$('#editAgrIframe').attr('src','editAgreement.php?agid='+agid+'&agyear='+agyear);	}	</script>