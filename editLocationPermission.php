<?php include 'cdns.php'; include 'config.php'; session_start();?><style type="text/css">	.pagethings{		position: absolute;		left: 200px;		padding: 20px;	}	.nshw{		display: none;	}	.lightlabel{		background-color: #ccc !important;		padding-left: 5px !important;		font-size: 12px;		font-weight: bold;		padding: 0px;	}	.fstable tbody th{	  color: #000;	  font-size: 12px;	  font-weight: bold;	  padding: 5px !important;	}	.fstable tbody td{	  padding: 1px;	}	.frminp{	  padding: 4px !important;	  height:25px;	  border-radius: 4px;	  font-size: 11px;	  font-weight:550;	}	.frmbtn{	  padding: 2px 4px !important;	  font-size: 11px;	}	body{		background-color: #EDEDED;	}	.estable thead th,.estable tbody th{  font-size: 12px !important;  padding: 1px 2px !important;  text-align: center;  font-weight: 500;  border:2px solid #ccc;  margin:0px;}.estable thead th{  background-color:#b7e0f4;  color: #000;  font-size: 15px;  font-weight: bold;  padding: 7px 3px !important;}.estable tbody td{  background-color: #fff !important;}label{	font-size: 12px;	font-weight: bold;}</style><div id="savmsg" class="alert alert-success frminp" style="display:none ;">Saved Successfully!</div><?phpif(isset($_REQUEST['added']) && $_REQUEST['added']=='yes'){	?>	<script type="text/javascript">		$("#savmsg").show(300);		setTimeout(function(){ $("#savmsg").hide(300);  }, 3000);	</script>	<?php}?><?php/*============================================here taking all the districts and putting on a array, so in below Tahsil loop we don't have to fetch all states again and again...==============================================*/$alls=mysql_query('SELECT * FROM `state`');while ($allsd=mysql_fetch_assoc($alls)){	$sarr[$allsd['StateId']]=$allsd['StateName'];}$sel=mysql_query("SELECT s.StateId,s.StateName FROM `user_location` ul, state s where ul.`state_id`!=0 and ul.sts='A' and ul.uid='".$_REQUEST['uid']."' and ul.state_id=s.StateId order by StateName asc");while ($sels=mysql_fetch_assoc($sel)) {	$csarr[$sels['StateId']]=$sels['StateName'];}if(sizeof($csarr) == 0){ $csarr[0]=''; }$seld=mysql_query("SELECT d.DictrictId,d.DictrictName FROM `user_location` ul, distric d where ul.`district_id`!=0 and ul.sts='A' and ul.uid='".$_REQUEST['uid']."' and ul.district_id=d.DictrictId order by DictrictName asc");while ($seldd=mysql_fetch_assoc($seld)) {	$cdarr[$seldd['DictrictId']]=$seldd['DictrictName'];}if(sizeof($cdarr) == 0){ $cdarr[0]=''; }$selt=mysql_query("SELECT t.TahsilId, t.TahsilName FROM `user_location` ul, tahsil t where ul.`tahsil_id`!=0 and ul.sts='A' and ul.uid='".$_REQUEST['uid']."' and ul.tahsil_id=t.TahsilId order by TahsilName asc");while ($seltd=mysql_fetch_assoc($selt)) {	$ctarr[$seltd['TahsilId']]=$seltd['TahsilName'];}if(sizeof($ctarr) == 0){ $ctarr[0]=''; }$selv=mysql_query("SELECT v.VillageId, v.VillageName FROM `user_location` ul, village v where ul.`village_id`!=0 and ul.sts='A' and ul.uid='".$_REQUEST['uid']."' and ul.village_id=v.VillageId order by VillageName asc");while ($selvd=mysql_fetch_assoc($selv)) {	$cvarr[$selvd['VillageId']]=$selvd['VillageName'];}if(sizeof($cvarr) == 0){ $cvarr[0]=''; }$allo=mysql_query('SELECT * FROM `organiser`');while ($allod=mysql_fetch_assoc($allo)) {	$oarr[$allod['oid']]=$allod['oname'];}$us=mysql_query('SELECT * FROM `users` where uId='.$_REQUEST['uid']);$usd=mysql_fetch_assoc($us);?><form id="farmertable"  enctype="multipart/form-data" method="post" action="mastersAjax.php">	<input type="hidden" name="act" value="addfarmer">	<table class=" fstable table table-bordered" >				<tbody  >		<tr>			<td colspan="8" style="font-weight: bold;"><?=$usd['uName']?></td>		</tr>		<tr>			<td colspan="8" class="lightlabel">Location Permissions</td>		</tr>		<tr>			<td>				<table class=" estable" style="">					<thead>					<tr>						<th style="width: 200px;">                         							<?php /*<input  type="checkbox"  onclick="checkBelowStates(this)" disabled>*/?>							State 							<script type="text/javascript">								function checkBelowStates(th){									if($(th).prop('checked') == true){										$(".states").prop('checked', true);										$(".states").trigger('change');									}else if($(th).prop('checked') == false){										$(".states").prop('checked', false);										$(".states").trigger('change');									}								}							</script>						</th>						<th style="width: 200px;">							<?php /*<input  type="checkbox"  onclick="checkBelowDistricts(this)" disabled>*/?>							District 							<script type="text/javascript">								function checkBelowDistricts(th){									if($(th).prop('checked') == true){										$(".districts").prop('checked', true);										$(".districts").trigger('change');									}else if($(th).prop('checked') == false){										$(".districts").prop('checked', false);										$(".districts").trigger('change');									}								}							</script>						</th>						<th style="width: 200px;">							<?php /*<input  type="checkbox"  onclick="checkBelowTahsils(this)" disabled>*/ ?>							Tahsil 							<script type="text/javascript">								function checkBelowTahsils(th){									if($(th).prop('checked') == true){										$(".tahsils").prop('checked', true);										$(".tahsils").trigger('change');									}else if($(th).prop('checked') == false){										$(".tahsils").prop('checked', false);										$(".tahsils").trigger('change');									}								}							</script>						</th>						<th style="width: 200px;">							<?php /*<input  type="checkbox"  onclick="checkBelowVillages(this)" disabled>*/?>							Village 							<script type="text/javascript">								function checkBelowVillages(th){									if($(th).prop('checked') == true){										$(".villages").prop('checked', true);										$(".villages").trigger('change');									}else if($(th).prop('checked') == false){										$(".villages").prop('checked', false);										$(".villages").trigger('change');									}								}							</script>						</th>					</tr>					</thead>					<tbody>					<tr>						<td>							<div style="height: 320px; overflow: scroll;">							<?php							foreach ($sarr as $key => $value){								?>								<label style="width: 100%;  <?php if (in_array($value, $csarr)){ echo 'background-color: #4CAF50;color:white;';} ?>">									<input  id="chkst<?=$key?>" type="checkbox" name="state" value="<?=$key?>" class="states" onclick="lstate(this.value,this,'<?=$value?>','<?=$_REQUEST['uid']?>')" <?php if (in_array($value, $csarr)){ echo 'checked';} ?> >									<?=$value?>								</label><br>																<?php							}							?>							</div>						</td>						<!-- ===================================================================================							this div is hided because district permission is said to hide after the code builded, but the districts permission is working fine,if you need to show district just remove display:none below  and also remove the display:none from above <th> tags						    ===================================================================================== -->						<td >														<div id="districtList" style="height: 320px; overflow: scroll;">								<?php								foreach ($csarr as $key => $value){									?>									<div style="background-color: #d9d9d9;font-size:13px;font-weight: bold;width:100%;">										<input id="alldis<?=$key?>" type="checkbox" name="" onclick="checkalldi('<?='state'.$key?>',this)"><?=$value?>										<script type="text/javascript">											function checkalldi(sid,th){												if($(th).prop('checked') == true){													$("."+sid).prop('checked', true);													$("."+sid).trigger('change');												}else if($(th).prop('checked') == false){													$("."+sid).prop('checked', false);													$("."+sid).trigger('change');												}																							}										</script>									</div>																											<?php									$alld=mysql_query('SELECT * FROM `distric` where StateId='.$key.' order by DictrictName asc');									while ($alldd=mysql_fetch_assoc($alld)){										?>										<label style="width: 100%;  <?php if (in_array($alldd['DictrictName'], $cdarr)){ echo 'background-color: #4CAF50;color:white;';} ?> ">											<input id="chkdi<?=$alldd['DictrictId']?>" type="checkbox" class="state<?=$key?> districts" value="<?=$alldd['DictrictId']?>" onchange="ldistrict(this.value,this,'<?=$alldd['DictrictName']?>','<?=$_REQUEST['uid']?>')" <?php if (in_array($alldd['DictrictName'], $cdarr)){ echo 'checked';} ?>>											<?=$alldd['DictrictName']?>										</label><br>										<?php									}								}								?>							</div>						</td>						<!-- =========================================================================================							this div is hided because tahsil permission is said to hide after the code builded, but the tahsil permission is working fine,if you need to show tahsil just remove display:none below and also remove the display:none from above <th> tags 						  	======================================================================================= -->						<td >														<div id="tahsilList" style="height: 320px; overflow: scroll;">								<?php								foreach ($cdarr as $key => $value){									?>									<div style="background-color: #d9d9d9;font-size:13px;font-weight: bold;width:100%;">										<input id="alltah<?=$key?>"  type="checkbox"  onclick="checkalltah('<?='dist'.$key?>',this)"><?=$value?>										<script type="text/javascript">											function checkalltah(did,th){												if($(th).prop('checked') == true){													$("."+did).prop('checked', true);													$("."+did).trigger('change');												}else if($(th).prop('checked') == false){													$("."+did).prop('checked', false);													$("."+did).trigger('change');												}											}										</script>									</div>																											<?php									$allt=mysql_query('SELECT * FROM `tahsil` where DistrictId='.$key.' order by TahsilName asc');									while ($alltd=mysql_fetch_assoc($allt)){										?>																				<label style="width: 100%; <?php if (in_array($alltd['TahsilName'], $ctarr)){ echo 'background-color: #4CAF50;color:white;';} ?>">											<input id="chkta<?=$alltd['TahsilId']?>" type="checkbox" class="dist<?=$_POST['did']?> tahsils" name="state" value="<?=$alltd['TahsilId']?>" onchange="ltahsil(this.value,this,'<?=$alltd['TahsilName']?>','<?=$_REQUEST['uid']?>')" <?php if (in_array($alltd['TahsilName'], $ctarr)){ echo 'checked';} ?> >											<?=$alltd['TahsilName']?>										</label><br>										<?php									}								}								?>							</div>						</td>						<td >														<div id="villageList" style="height: 320px; overflow: scroll;">								<?php								foreach ($ctarr as $key => $value){									?>									<div style="background-color: #d9d9d9;font-size:13px;font-weight: bold;width:100%;">										<input id="allvill<?=$key?>"  type="checkbox"  onclick="checkallvill('<?='tah'.$key?>',this)"><?=$value?>										<script type="text/javascript">											function checkallvill(tid,th){												if($(th).prop('checked') == true){													$("."+tid).prop('checked', true);													$("."+tid).trigger('change');												}else if($(th).prop('checked') == false){													$("."+tid).prop('checked', false);													$("."+tid).trigger('change');												}											}										</script>									</div>																											<?php									$allt=mysql_query('SELECT * FROM `village` where TahsilId='.$key.' order by VillageName asc');									while ($alltd=mysql_fetch_assoc($allt)){										?>										<label style="width: 100%; <?php if (in_array($alltd['VillageName'], $cvarr)){ echo 'background-color: #4CAF50;color:white;';} ?>">											<input id="chkvill<?=$alltd['VillageId']?>" type="checkbox" class="tah<?=$_POST['tid']?> villages" name="state" value="<?=$alltd['VillageId']?>" onchange="lvillage(this.value,this,'<?=$alltd['VillageName']?>','<?=$_REQUEST['uid']?>')"  <?php if (in_array($alltd['VillageName'], $cvarr)){ echo 'checked';} ?>>											<?=$alltd['VillageName']?>										</label><br>										<?php									}								}								?>							</div>						</td>											</tr>					</tbody>				</table>			</td>		</tr>				</tbody>			</table></form><button type="button" class="frmbtn btn btn-sm btn-danger" style="width:100px;position: absolute;top:4px;right: 4px;" onclick="closediv('<?=$_REQUEST['uid']?>')"  >Close</button>				</center><script type="text/javascript">	function closediv(uid){		$('#editUDiv', window.parent.document).hide(500);		$('#epbtn'+uid, window.parent.document).show();		$('#editingbtn'+uid, window.parent.document).hide();		window.parent.document.getElementById('addfarbtn').style.display='block';	}</script><!-- this dump div is being used on js lstate function to take js scripts from ajax file  --><div id="dump">	&nbsp;</div><!-- this dump div is being used on js lstate function to take js scripts from ajax file  --><script type="text/javascript">		function lstate(sid,sth,sname,uid){				if($(sth).prop("checked") == true){            $(sth).parent().css("background-color","#4CAF50");            $(sth).parent().css("color","#fff");            $.post("mastersAjax.php",{ act:'addlocation',sid:sid,uid:uid },function(data) {});            $.post("mastersAjax.php",{ act:'getStateDistricts',sid:sid,sname:sname,uid:uid },function(data) {				$('#districtList').append(data);	        });	        }else if($(sth).prop("checked") == false){            $(sth).parent().css("background-color","#fff");            $(sth).parent().css("color","#000");            $.post("mastersAjax.php",{ act:'removelocation',sid:sid,uid:uid },function(data) {             $('#dump').html(data);	        });            $('.stdiss'+sid).hide();        }        	}	function ldistrict(did,dth,dname,uid){		if($(dth).prop("checked") == true){            $(dth).parent().css("background-color","#4CAF50");            $(dth).parent().css("color","#fff");            $.post("mastersAjax.php",{ act:'addlocation',did:did,uid:uid},function(data) {});            $.post("mastersAjax.php",{ act:'getDistrictTahsils',did:did,dname:dname,uid:uid },function(data) {				$('#tahsilList').append(data);	          }	        );        }else if($(dth).prop("checked") == false){            $(dth).parent().css("background-color","#fff");            $(dth).parent().css("color","#000");            $.post("mastersAjax.php",{ act:'removelocation',did:did,uid:uid },function(data) {});            $('.ditahs'+did).hide();        }        	}	function ltahsil(tid,tth,tname,uid){		if($(tth).prop("checked") == true){            $(tth).parent().css("background-color","#4CAF50");            $(tth).parent().css("color","#fff");            $.post("mastersAjax.php",{ act:'addlocation',tid:tid,uid:uid },function(data) {});            $.post("mastersAjax.php",{ act:'getTahsilVillages',tid:tid,tname:tname,uid:uid },function(data) {				$('#villageList').append(data);	          }	        );        }else if($(tth).prop("checked") == false){            $(tth).parent().css("background-color","#fff");            $(tth).parent().css("color","#000");            $.post("mastersAjax.php",{ act:'removelocation',tid:tid,uid:uid},function(data) {});        }        	}	function lvillage(vid,tth,tname,uid){		if($(tth).prop("checked") == true){            $(tth).parent().css("background-color","#4CAF50");            $(tth).parent().css("color","#fff");            $.post("mastersAjax.php",{ act:'addlocation',vid:vid,uid:uid },function(data) {});    //         $.post("mastersAjax.php",{ act:'getTahsilVillages',vid:vid,tname:tname,uid:uid },function(data) {				// $('#villageList').append(data);	   //        }	   //      );        }else if($(tth).prop("checked") == false){            $(tth).parent().css("background-color","#fff");            $(tth).parent().css("color","#000");            $.post("mastersAjax.php",{ act:'removelocation',vid:vid,uid:uid},function(data) {});        }        	}</script><?php/*$sel=mysql_query("SELECT ul.*,s.StateName FROM `user_location` ul, state s where ul.`state_id`!=0 and ul.sts='A' and ul.uid='".$_REQUEST['uid']."' and ul.state_id=s.StateId");while ($sels=mysql_fetch_assoc($sel)) {	?>	<script type="text/javascript">		//$("<?='#chkst'.$sels['state_id']?>").prop("checked",true);		//lstate('<?=$sels['state_id']?>','<?='#chkst'.$sels['state_id']?>','<?=$sels['StateName']?>','<?=$_REQUEST['uid']?>');	</script>	<?php}*/?>